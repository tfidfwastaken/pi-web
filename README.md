# Pi Web Frontend

> âš ï¸ **Disclaimer: This is clankerslop.** This project was generated by an AI coding agent in a single session. Use at your own risk, expect bugs, and verify before trusting.

A web application frontend for the [pi coding agent](https://github.com/badlogic/pi-mono) with full feature parity to the terminal TUI.

## Features

- ğŸ’¬ **Full Chat Interface** - Message streaming, thinking blocks, tool execution display
- ğŸ› ï¸ **Tool Visualization** - Bash output, file reads, edits, and writes with syntax highlighting
- ğŸŒ² **Session Management** - Session list, tree navigation, branching, and forking
- ğŸ¤– **Model & Thinking Control** - Model selector with search, thinking level controls
- ğŸ”Œ **Extension Support** - Extension UI dialogs (select, confirm, input)
- âŒ¨ï¸ **Keyboard Shortcuts** - TUI-like keybindings
- ğŸ¨ **Dark Theme** - Tailwind-based dark mode design
- ğŸ–¼ï¸ **Image Attachments** - Paste or drag-drop images into chat
- âš¡ **Slash Commands** - Autocomplete for commands, prompts, and skills

## Quick Start

### 1. Install dependencies

```bash
cd pi-web
npm install
```

### 2. Build all packages

```bash
npm run build
```

### 3. Start the backend server

```bash
npm run dev -w @pi-web/backend
```

The backend server will start on `ws://localhost:3001` by default.

### 4. Start the frontend development server

In a new terminal:

```bash
npm run dev -w @pi-web/frontend
```

The frontend will be available at `http://localhost:3000`.

### 5. Connect to a project

1. Open `http://localhost:3000` in your browser
2. Enter the WebSocket URL (default: `ws://localhost:3001`)
3. Enter the working directory path for your project
4. Click "Connect"

## Architecture

```
Browser                          Server
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  React Frontend  â”‚  WebSocket â”‚  Node.js Server  â”‚
â”‚  - Chat UI       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  - WS Handler    â”‚
â”‚  - Store         â”‚            â”‚  - Process Mgmt  â”‚
â”‚  - Dialogs       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  - Bridge        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ stdio
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚  pi --mode rpc   â”‚
                                â”‚  - Agent Loop    â”‚
                                â”‚  - Tools         â”‚
                                â”‚  - Extensions    â”‚
                                â”‚  - Sessions      â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| `Enter` | Send message |
| `Shift+Enter` | New line in input |
| `Escape` | Abort streaming / Close dialog |
| `Ctrl+P` | Cycle model |
| `Ctrl+L` | Open model selector |
| `Shift+Tab` | Cycle thinking level |
| `Ctrl+O` | Toggle tools collapsed |
| `Ctrl+Shift+O` | Toggle thinking collapsed |
| `Ctrl+R` | Open session selector (resume) |
| `Ctrl+T` | Open session tree |
| `Ctrl+F` | Fork session |
| `Ctrl+N` | New session |
| `Ctrl+,` | Open settings |
| `Ctrl+B` | Toggle sidebar |
| `Ctrl+V` | Paste image |

## Configuration

### Backend Environment Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `PORT` | `3001` | WebSocket server port |
| `HOST` | `0.0.0.0` | Server host |
| `PI_CWD` | Current directory | Default working directory |
| `PI_COMMAND` | `pi` | Path to pi executable |

Create a `.env` file in `packages/backend/`:

```env
PORT=3001
HOST=0.0.0.0
PI_CWD=/home/user/projects/my-project
PI_COMMAND=pi
```

### Frontend Environment Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `VITE_WS_URL` | `ws://localhost:3001` | WebSocket URL |

## Project Structure

```
pi-web/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared/              # Shared types (RPC protocol)
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â””â”€â”€ index.ts     # Type definitions
â”‚   â”‚
â”‚   â”œâ”€â”€ backend/             # WebSocket server
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ server.ts    # WebSocket handler
â”‚   â”‚       â”œâ”€â”€ session.ts   # Pi process management
â”‚   â”‚       â””â”€â”€ cli.ts       # CLI entry point
â”‚   â”‚
â”‚   â””â”€â”€ frontend/            # React web app
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ components/  # React components
â”‚           â”‚   â”œâ”€â”€ chat/    # Chat UI
â”‚           â”‚   â”œâ”€â”€ dialogs/ # Modal dialogs
â”‚           â”‚   â”œâ”€â”€ layout/  # App shell
â”‚           â”‚   â””â”€â”€ ui/      # UI primitives
â”‚           â”œâ”€â”€ rpc/         # WebSocket client
â”‚           â”œâ”€â”€ store/       # Zustand state
â”‚           â””â”€â”€ hooks/       # React hooks
â”‚
â”œâ”€â”€ package.json             # Workspace root
â””â”€â”€ README.md
```

## Development

### Run tests

```bash
npm run test
```

### Type checking

```bash
npm run typecheck
```

### Build for production

```bash
npm run build
```

The frontend build output will be in `packages/frontend/dist/`.

## Implemented Features

### Phase 1: Basic Chat âœ…
- [x] WebSocket connection to backend
- [x] Pi process spawning and management
- [x] Message streaming (text, thinking, tool calls)
- [x] User message display
- [x] Assistant message with Markdown rendering
- [x] Thinking blocks (collapsible)
- [x] Tool call/result display
- [x] Tool-specific rendering (bash, read, edit, write)
- [x] Model selector (cycle with Ctrl+P)
- [x] Thinking level selector (cycle with Shift+Tab)
- [x] Extension UI dialogs (select, confirm, input)
- [x] Toast notifications
- [x] Keyboard shortcuts
- [x] Compaction summary display
- [x] Branch summary display

### Phase 2: Tool Display âœ…
- [x] Bash output with syntax highlighting
- [x] File read display with line numbers
- [x] Edit tool diff display
- [x] Write tool file content display

### Phase 3: Session Management âœ…
- [x] Session list and selector dialog
- [x] Session search and filtering
- [x] Session tree navigator
- [x] Fork dialog (select message to fork from)
- [x] New session command
- [x] Session rename
- [x] Session delete with confirmation

### Phase 4: Model & Settings âœ…
- [x] Model selector dialog with search
- [x] Available models list grouped by provider
- [x] Model info (pricing, context window, capabilities)
- [x] Thinking level selector with colors
- [x] Settings dialog with tabs
- [x] Keyboard shortcuts reference

### Phase 5: Extension UI âœ…
- [x] Select dialog component
- [x] Confirm dialog component
- [x] Input dialog component
- [x] Dialog queue management
- [x] Notification toast system

### Phase 6: Advanced Features âœ…
- [x] Image attachments (paste with Ctrl+V)
- [x] Drag-drop image support
- [x] Image preview thumbnails
- [x] Slash command autocomplete
- [x] Fuzzy search for commands

## Coming Soon

- [ ] Diff view for edit tool (Monaco)
- [ ] Syntax highlighting with Shiki
- [ ] Theme selection (light/dark)
- [ ] Session export to HTML
- [ ] Message virtualization for long sessions
- [ ] Editor dialog for extensions

## Related Projects

- [pi-mono](https://github.com/badlogic/pi-mono) - Pi coding agent monorepo
- [@mariozechner/pi-coding-agent](https://www.npmjs.com/package/@mariozechner/pi-coding-agent) - Pi CLI

## License

MIT
