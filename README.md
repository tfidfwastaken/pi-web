# Pi Web Frontend

> âš ï¸ **Disclaimer: This is clankerslop.** This project was generated by an AI coding agent in a single session. Use at your own risk, expect bugs, and verify before trusting.

A web application frontend for the [pi coding agent](https://github.com/badlogic/pi-mono) with full feature parity to the terminal TUI.

## Features

- ğŸ’¬ **Full Chat Interface** - Message streaming, thinking blocks, tool execution display
- ğŸ› ï¸ **Tool Visualization** - Bash output, file reads, edits, and writes with syntax highlighting
- ğŸŒ² **Session Management** - Tree-based branching (coming soon)
- ğŸ¤– **Model & Thinking Control** - Cycle models and thinking levels
- ğŸ”Œ **Extension Support** - Extension UI dialogs (select, confirm, input)
- âŒ¨ï¸ **Keyboard Shortcuts** - TUI-like keybindings
- ğŸ¨ **Dark Theme** - Tailwind-based dark mode design

## Quick Start

### 1. Install dependencies

```bash
cd pi-web
npm install
```

### 2. Build all packages

```bash
npm run build
```

### 3. Start the backend server

```bash
npm run dev -w @pi-web/backend
```

The backend server will start on `ws://localhost:3001` by default.

### 4. Start the frontend development server

In a new terminal:

```bash
npm run dev -w @pi-web/frontend
```

The frontend will be available at `http://localhost:3000`.

### 5. Connect to a project

1. Open `http://localhost:3000` in your browser
2. Enter the WebSocket URL (default: `ws://localhost:3001`)
3. Enter the working directory path for your project
4. Click "Connect"

## Architecture

```
Browser                          Server
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  React Frontend  â”‚  WebSocket â”‚  Node.js Server  â”‚
â”‚  - Chat UI       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  - WS Handler    â”‚
â”‚  - Store         â”‚            â”‚  - Process Mgmt  â”‚
â”‚  - Dialogs       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  - Bridge        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ stdio
                                       â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚  pi --mode rpc   â”‚
                                â”‚  - Agent Loop    â”‚
                                â”‚  - Tools         â”‚
                                â”‚  - Extensions    â”‚
                                â”‚  - Sessions      â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| `Enter` | Send message |
| `Shift+Enter` | New line in input |
| `Escape` | Abort streaming |
| `Ctrl+P` | Cycle model |
| `Shift+Tab` | Cycle thinking level |
| `Ctrl+O` | Toggle tools collapsed |

## Configuration

### Backend Environment Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `PORT` | `3001` | WebSocket server port |
| `HOST` | `0.0.0.0` | Server host |
| `PI_CWD` | Current directory | Default working directory |
| `PI_COMMAND` | `pi` | Path to pi executable |

Create a `.env` file in `packages/backend/`:

```env
PORT=3001
HOST=0.0.0.0
PI_CWD=/home/user/projects/my-project
PI_COMMAND=pi
```

### Frontend Environment Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `VITE_WS_URL` | `ws://localhost:3001` | WebSocket URL |

## Project Structure

```
pi-web/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared/              # Shared types (RPC protocol)
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â””â”€â”€ index.ts     # Type definitions
â”‚   â”‚
â”‚   â”œâ”€â”€ backend/             # WebSocket server
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ server.ts    # WebSocket handler
â”‚   â”‚       â”œâ”€â”€ session.ts   # Pi process management
â”‚   â”‚       â””â”€â”€ cli.ts       # CLI entry point
â”‚   â”‚
â”‚   â””â”€â”€ frontend/            # React web app
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ components/  # React components
â”‚           â”‚   â”œâ”€â”€ chat/    # Chat UI
â”‚           â”‚   â”œâ”€â”€ dialogs/ # Modal dialogs
â”‚           â”‚   â”œâ”€â”€ layout/  # App shell
â”‚           â”‚   â””â”€â”€ ui/      # UI primitives
â”‚           â”œâ”€â”€ rpc/         # WebSocket client
â”‚           â”œâ”€â”€ store/       # Zustand state
â”‚           â””â”€â”€ hooks/       # React hooks
â”‚
â”œâ”€â”€ package.json             # Workspace root
â””â”€â”€ README.md
```

## Development

### Run tests

```bash
npm run test
```

### Type checking

```bash
npm run typecheck
```

### Build for production

```bash
npm run build
```

The frontend build output will be in `packages/frontend/dist/`.

## Implemented Features (Phase 1)

- [x] WebSocket connection to backend
- [x] Pi process spawning and management
- [x] Message streaming (text, thinking, tool calls)
- [x] User message display
- [x] Assistant message with Markdown rendering
- [x] Thinking blocks (collapsible)
- [x] Tool call/result display
- [x] Tool-specific rendering (bash, read, edit, write)
- [x] Model selector (cycle with Ctrl+P)
- [x] Thinking level selector (cycle with Shift+Tab)
- [x] Extension UI dialogs (select, confirm, input)
- [x] Toast notifications
- [x] Keyboard shortcuts
- [x] Compaction summary display
- [x] Branch summary display

## Coming Soon (Phase 2+)

- [ ] Session list and selector
- [ ] Session tree navigator
- [ ] Fork dialog
- [ ] Model selector dialog
- [ ] Settings dialog
- [ ] Image attachments (paste, drag-drop)
- [ ] Slash command autocomplete
- [ ] Diff view for edit tool
- [ ] Syntax highlighting with Shiki
- [ ] Theme selection
- [ ] Session export to HTML

## Related Projects

- [pi-mono](https://github.com/badlogic/pi-mono) - Pi coding agent monorepo
- [@mariozechner/pi-coding-agent](https://www.npmjs.com/package/@mariozechner/pi-coding-agent) - Pi CLI

## License

MIT
